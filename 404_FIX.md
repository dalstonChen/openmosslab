# Fix for 404 Errors on Content Pages

## Problem

After deploying to GitHub Pages, all content pages (People, Career, Publications, etc.) were returning **404 - File not found** errors when accessed.

**Example**:
- Homepage: ✅ `https://dalstonchen.github.io/openmosslab/` worked
- People page: ❌ `https://dalstonchen.github.io/openmosslab/people/` showed 404

## Root Cause

Content files were located in the `_content/` directory, which is a custom collection. However, Jekyll wasn't properly configured to output these as pages, so they weren't being generated during the build process.

In Jekyll:
- Files in `_underscore` directories are treated as special collections/data
- Regular page files should be in the root directory or in non-underscore directories
- The `_content/` directory wasn't being processed correctly to generate the pages

## Solution Applied

### 1. Moved Content Files to Root Directory

**Before**:
```
openmosslab/
├── _content/
│   ├── people.md
│   ├── publications.md
│   ├── software.md
│   ├── resources.md
│   ├── career.md
│   └── join.md
└── index.md
```

**After**:
```
openmosslab/
├── index.md
├── people.md
├── publications.md
├── software.md
├── resources.md
├── career.md
└── join.md
```

**Command used**:
```bash
mv _content/*.md .
rmdir _content
```

### 2. Updated `_config.yml` to Exclude Documentation Files

Added documentation Markdown files to the exclude list so they don't generate pages:

```yaml
exclude:
  - Gemfile
  - Gemfile.lock
  - node_modules
  - vendor
  - README.md
  - SETUP.md
  - QUICKSTART.md
  - PROJECT_SUMMARY.md
  - ARCHITECTURE.md
  - DEPLOYMENT_CONFIG.md
  - FIXES_APPLIED.md
  - content.txt
  - "The Stanford Natural Language Processing Group_files"
```

**Removed** the collections configuration that was causing issues:
```yaml
# Removed this:
collections:
  pages:
    output: true
    permalink: /:path/
```

### 3. Recreated GitHub Actions Workflow

The `.github` directory was missing, so I recreated the deployment workflow:

**File**: `.github/workflows/deploy.yml`

**Key features**:
- Triggers on pushes to `main` branch
- Watches for changes to `*.md` files (except documentation)
- Watches for changes to layouts, includes, assets, and config
- Builds with Jekyll and deploys to GitHub Pages

### 4. Updated Documentation

Updated these files to reflect the new structure:
- `README.md` - Changed references from `_content/` to root directory
- Documentation files now correctly describe file locations

## How Jekyll Processes Pages Now

### File Structure for Pages

Jekyll now finds and processes content files in this order:

1. **`index.md`** → generates `/openmosslab/index.html`
2. **`people.md`** with `permalink: /people/` → generates `/openmosslab/people/index.html`
3. **`career.md`** with `permalink: /career/` → generates `/openmosslab/career/index.html`
4. And so on for each `.md` file in the root

### Front Matter Example

Each content page has proper front matter:

```yaml
---
layout: page
title: People
permalink: /people/
---

## Content goes here...
```

- `layout: page` → Uses `_layouts/page.html` template
- `title: People` → Page title
- `permalink: /people/` → URL path (Jekyll adds baseurl automatically)

### Build Process

1. Jekyll reads all `.md` files in root (except those in `exclude` list)
2. Processes front matter and Markdown content
3. Applies the specified layout template
4. Generates HTML files in `_site/` directory
5. GitHub Pages serves the `_site/` content

## Verification

### Check File Locations

```bash
ls -la *.md
```

Should show:
- ✅ `index.md`
- ✅ `people.md`
- ✅ `publications.md`
- ✅ `software.md`
- ✅ `resources.md`
- ✅ `career.md`
- ✅ `join.md`

Plus documentation files (which are excluded from build).

### Check Front Matter

Each content page should have:
```yaml
---
layout: page
title: [Page Title]
permalink: /[url-path]/
---
```

### Check Configuration

In `_config.yml`:
- ✅ `baseurl: "/openmosslab"`
- ✅ `url: "https://dalstonchen.github.io"`
- ✅ Documentation files in `exclude` list
- ✅ No `collections` configuration

## Deployment Instructions

### 1. Commit All Changes

```bash
cd "/Users/dalstonchen/Library/CloudStorage/GoogleDrive-dalstonchen@gmail.com/My Drive/Job/fudan/projects/openmosslab"

# Check status
git status

# Add all changes
git add .

# Commit with descriptive message
git commit -m "Fix 404 errors: Move content files to root and configure Jekyll properly"

# Push to GitHub
git push origin main
```

### 2. Monitor Deployment

1. Go to: https://github.com/dalstonchen/openmosslab/actions
2. Watch the "Deploy Jekyll site to GitHub Pages" workflow
3. Wait for green checkmark (usually 2-3 minutes)

### 3. Test All Pages

Once deployed, test these URLs:

- ✅ https://dalstonchen.github.io/openmosslab/ (Homepage)
- ✅ https://dalstonchen.github.io/openmosslab/people/
- ✅ https://dalstonchen.github.io/openmosslab/publications/
- ✅ https://dalstonchen.github.io/openmosslab/software/
- ✅ https://dalstonchen.github.io/openmosslab/resources/
- ✅ https://dalstonchen.github.io/openmosslab/career/
- ✅ https://dalstonchen.github.io/openmosslab/join/

### 4. Clear Browser Cache

If pages still show 404:
- Hard refresh: **Ctrl+F5** (Windows/Linux) or **Cmd+Shift+R** (Mac)
- Or open in incognito/private browsing mode

## Expected Results

✅ All navigation links work correctly
✅ All content pages load without 404 errors
✅ CSS styles applied to all pages
✅ Images and assets load correctly
✅ Active navigation state highlights current page

## What's Different Now

### Before (Broken)

```
Structure:
_content/
  └── people.md

Result: Jekyll didn't generate page
URL: 404 error
```

### After (Fixed)

```
Structure:
people.md (in root)

Result: Jekyll generates /openmosslab/people/index.html
URL: https://dalstonchen.github.io/openmosslab/people/ ✅
```

## Why This Approach Works

1. **Simplicity**: No complex collections configuration needed
2. **Standard Jekyll**: Uses Jekyll's default page processing
3. **Clear Structure**: Content files in root are easy to find and edit
4. **Proper Separation**: Documentation files excluded, content files processed
5. **Reliable Build**: Jekyll's standard processing is well-tested

## Future Content Updates

### To Edit Existing Pages

1. Edit the `.md` file in the root directory (e.g., `people.md`)
2. Commit and push
3. Wait for automatic deployment

### To Add New Pages

1. Create `newpage.md` in root directory:
   ```yaml
   ---
   layout: page
   title: New Page
   permalink: /newpage/
   ---

   Your content here...
   ```

2. Add to navigation in `_config.yml`:
   ```yaml
   navigation:
     - title: "new page"
       url: "/newpage/"
   ```

3. Commit and push

## Troubleshooting

### If Pages Still Show 404

1. **Check file exists**: `ls -la people.md`
2. **Check front matter**: Open file and verify YAML front matter
3. **Check GitHub Actions**: Look for build errors
4. **Check baseurl**: Should be `/openmosslab` in `_config.yml`
5. **Clear cache**: Hard refresh browser

### If Build Fails on GitHub Actions

1. Go to Actions tab in GitHub repository
2. Click on failed workflow run
3. Read error messages
4. Common issues:
   - YAML syntax error in front matter
   - Missing `permalink` in front matter
   - Typo in layout name

## Summary of Changes

| Item | Before | After |
|------|--------|-------|
| Content location | `_content/` directory | Root directory |
| Collections config | Had custom collection | Removed (using defaults) |
| Exclude list | Minimal | Complete (all docs excluded) |
| GitHub Actions | Missing `.github` directory | Created workflow file |
| Documentation | Referenced `_content/` | Updated to reference root |

## Files Modified

1. **Moved**: All files from `_content/` to root
2. **Updated**: `_config.yml` - removed collections, updated exclude list
3. **Created**: `.github/workflows/deploy.yml`
4. **Updated**: `README.md` - updated directory references
5. **Created**: This file (`404_FIX.md`)

---

**Status**: ✅ Ready to deploy

**Next Step**: Commit and push all changes, then verify pages load correctly after deployment.
